<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Blog &middot; Psychstatistics
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <script type="text/javascript"
          src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
		  
</head>




  <body  class="theme-base-0d">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h2>
        <a href="/">
          Psychstatistics
        </a>
      </h2>
      <p class="lead">Trying to be thoughtful</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">Current Research</a>
          
        
      
        
      
        
      
        
          
        
      
        
      
	  
	  <a class="sidebar-nav-item" href="/blog/index.html">Blog</a>    </nav>

    <p>&copy; 2014. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/08/18/stata-do-file-log-files/">
        Stata: Do-files and Log-files
      </a>
    </h1>

    <span class="post-date">18 Aug 2011</span>
    <p>As you begin to work with datasets, there are two record and save your commands and actions in Stata.</p>

<h2 id="creating-do-files">Creating do-files</h2>

<p>Do-files allow you to record all of your commands. There are a number of benefits to using do-files. By using do-files to run your commands, you have a copy of what you did, which allows you and other researchers to replicate your analyses exactly. It also allows you to run analyses without changing your original data file until you are ready to save out a clean data set. Many researchers will keep a do-file recording data management (addressing missing data, reverse-scoring if necessary, etc) and may have separate do-files for analyses for the final clean data set or subsets of the data. To create a do-file, you can either go to “File”-&gt;“New Do File” or you can use this icon on the toolbar in the Stata window.</p>

<p><img src="/assets/Picture-131.png" alt="Picture-131.png" /></p>

<p>You’re new do file should open in a separate window that looks like this:</p>

<p><img src="/assets/blank.dofile.png" alt="blank.dofile.png" /></p>

<p>One optional step that can be helpful in creating do-files is placing a comment at the top of the file denoting which data you’re using and any other notes you want. To separate notes and comments from commands in do-files, begin the line with an asterisk. If it is a longer note, you can set it apart by typing /* before your comment and */ after the comment. For example, if I were using a data set called “relate”, I might begin my data file like this:</p>

<p><img src="/assets/Picture-14.png" alt="Picture-14.png" /></p>

<p>The first command you will need is the <code>use</code> command to specify the file you want Stata to use. If the file is not in the working directory that you are currently in, just specify which directory you want to pull the file from. Here are three examples of the <code>use</code> command, one from a data set in the current working directly, one from the internet and one from a jump drive in a different working directory. Notice that on the end of each command, I add the option <code>clear</code>. This is to clear any data that Stata is currently working with.</p>

<pre><code>use relate.dta, clear
use http://www.stata-press.com/data/agis3/relate, clear
use "E:\relate.dta", clear
</code></pre>

<p>After I specify the data file, I enter the rest of the commands I want to run. Within this file, Stata will assume that each line is a new command unless you tell it otherwise. If you have a long command that you need on separate lines, add /// at the end of each line. That tells Stata that the next line is part of the same command. When I am ready to run the analyses, I select the commands I would like to run (you don’t have to select any text if you want to run them all) and click on the last icon on the toolbar in the do-file window:</p>

<p><img src="/assets/do.file_.toolbar.run_.png" alt="do.file_.toolbar.run_.png" /></p>

<p>To save your do-file, you can either use the icon on the toolbar or use the “File”-&gt;“Save As” menu while the do-file editor is active.</p>

<h2 id="creating-log-files">Creating log files</h2>

<p>In addition to recording all of your commands in a do-file, you can also have Stata create a copy of everything that is sent to the Results window, with the exception of graphs. This is called a log file and can be helpful for you to save all of your output. This will also retain your commands, although it will not save them in the same way a do-file does (they will be embedded in the output). To create a log file, go to “File” -&gt; “Log” -&gt; “Begin.” This will bring up a dialogue box where you will save your log file. The default in Stata is to save the file with the extension .smcl. This will allow you to open the log file in Stata, but other programs will not read this type of file. The other extension available is .log. This file format will allow you to open your log file in other programs and may be easier to manage than the .smcl files. To save it as a .log file, just select the Stata Log option under the “File Format” menu in the dialogue box.</p>

<p><img src="/assets/log.dialogue.choose.png" alt="log.dialogue.choose.png" /></p>

<p>Once you begin a log file, you can suspend it at any time and resume later. You can do this by going to the “File” -&gt; “Log” -&gt; “Suspend” (or “Resume”). You can also close your log using this menu.</p>

<p>You can also start, suspend, resume and close logs using the log command. I will use this command to begin a log file, specify the name and location of the file as well as the extension. If I were going to create a log file called “creatinglogfiles” in a file on my desktop called “501” (filepath: /Desktop/501), I would type:</p>

<pre><code>log using "/Desktop/501/creatinglogfiles", text
</code></pre>

<p>I included <code>text</code> because I want the file to be a .log file, not an .smcl file. If I wanted to overwrite a file that already existed, I would add <code>replace</code> after <code>text</code>.</p>

<p>After the log file is open, typing <code>log off</code> will suspend the log file, <code>log on</code> will resume the log file and <code>log close</code> will close your log file.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/07/01/stata-oneway-anova/">
        Stata: Oneway ANOVA
      </a>
    </h1>

    <span class="post-date">01 Jul 2011</span>
    <h1 id="oneway-anova">Oneway ANOVA</h1>

<p>This post will show how to use the <code>anova</code> and <code>loneway</code> commands in Stata to compute a oneway ANOVA.
We will use the <strong>auto</strong> dataset for this illustration. We will use <em>price</em> as the outcome variable and <em>foreign</em> as the factor.</p>

<p>Let’s initially look at descriptive statistics for <em>price</em> stratified by <em>foreign</em>.</p>

<p><img src="/assets/Results-auto_dta.jpg" alt="Results-auto_dta_.jpg" /></p>

<p>So it looks like there is a difference between in price between foreign and domestic cars, with foreign cars costing more money. We can test whether this difference is statistically significant with a oneway ANOVA (you could also just a use a t-test since there are just two levels of <em>foreign</em>).</p>

<h2 id="anova-command"><code>anova</code> Command</h2>

<p>The <code>anova</code> command is simple and follows the standard Stata syntax – Command DV IV</p>

<pre><code>anova price foreign
</code></pre>

<p>Viola – you’ve got an ANOVA source table.</p>

<p><img src="/assets/Results-auto_dta-1.jpg" alt="Results-auto.dta-1.jpg" /></p>

<p>Looks like the difference in price is not statistically significant. The advantage of using <code>anova</code> is that you can fit lots of different ANOVA models using this command (e.g., factorial ANOVA, repeated measures ANOVA, nested ANOVA). However, if you just want to fit a oneway ANOVA, then you can use the <code>loneway</code> command.</p>

<h2 id="loneway-command"><code>loneway</code> Command</h2>

<p>The <code>loneway</code> command is just for oneway ANOVA models. It provides output in addition to the source table, such as the intraclass correlation and the reliability of the group means. So depending upon the analysis you want to do and the information you need, <code>loneway</code> can be really useful.</p>

<pre><code>loneway price foreign
</code></pre>

<p><img src="/assets/Results-auto_dta-2.jpg" alt="Results-auto_dta-2.jpg" /></p>


  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2011/05/30/things-i-love-about-stata-egen-mean/">
        Things I Love About Stata -- egen mean
      </a>
    </h1>

    <span class="post-date">30 May 2011</span>
    <h1 id="egen-mean">egen mean</h1>

<p>I work a lot with clustered data, including group psychotherapy data (people clustered in groups), individual psychotherapy data (people clustered within therapists), and longitudinal data (observations clustered within people). Consequently, I often need to create cluster-level means and grand means for graphing and modeling. The <code>egen mean</code> function makes creating means easy. Combining <code>egen mean</code> with <code>by</code> processing in Stata makes this a breeze, even when cluster sizes differ.</p>

<h2 id="egen-mean-for-grand-means"><code>egen mean</code> for grand means</h2>

<p>The <code>egen</code> function is used to create new variables. To create a mean with <code>egen</code> we use the following syntax:</p>

<pre><code>egen nameofnewvariable=mean(nameofoldvariable)
</code></pre>

<p>We can download the the pig data from the <code>xtmixed</code> help.</p>

<pre><code>webuse pig, clear
</code></pre>

<p>The variables are <strong>id</strong>, <strong>week</strong>, and <strong>weight</strong>.</p>

<pre><code>list in 1/15, clean
id week weight
1. 1 1 24
2. 1 2 32
3. 1 3 39
4. 1 4 42.5
5. 1 5 48
6. 1 6 54.5
7. 1 7 61
8. 1 8 65
9. 1 9 72
10. 2 1 22.5
11. 2 2 30.5
12. 2 3 40.5
13. 2 4 45
14. 2 5 51
15. 2 6 58.5
</code></pre>

<p>We can create a grand mean (say, for creating centered variables) of <strong>weight</strong> using <code>egen</code>.</p>

<pre><code>egen grandweight=mean(weight)
</code></pre>

<p>This creates a new variable that is equal to the grand mean for weight (it is a constant across all variables)</p>

<pre><code>list in 1/15, clean
id week weight grandw~t
1. 1 1 24 50.40509
2. 1 2 32 50.40509
3. 1 3 39 50.40509
4. 1 4 42.5 50.40509
5. 1 5 48 50.40509
6. 1 6 54.5 50.40509
7. 1 7 61 50.40509
8. 1 8 65 50.40509
9. 1 9 72 50.40509
10. 2 1 22.5 50.40509
11. 2 2 30.5 50.40509
12. 2 3 40.5 50.40509
13. 2 4 45 50.40509
14. 2 5 51 50.40509
15. 2 6 58.5 50.40509
</code></pre>

<h2 id="egen-mean-for-cluster-means"><code>egen mean</code> for cluster means</h2>

<p>We can combine <code>egen mean</code> with <code>by</code> to compute cluster means. (Remember that <strong>id</strong> is the cluster id variable.)</p>

<pre><code>by id: egen groupweight=mean(weight)
</code></pre>

<p>If the <strong>id</strong> variable isn’t sorted, then you can change the code to:</p>

<pre><code>by id, sort: egen groupweight=mean(weight)
</code></pre>

<p>This creates a variable that is equal to the cluster mean for each cluster. That is, its value is constant within clusters but varies across clusters.</p>

<pre><code>list in 1/15, clean
id week weight grandw~t groupw~t
1. 1 1 24 50.40509 48.66667
2. 1 2 32 50.40509 48.66667
3. 1 3 39 50.40509 48.66667
4. 1 4 42.5 50.40509 48.66667
5. 1 5 48 50.40509 48.66667
6. 1 6 54.5 50.40509 48.66667
7. 1 7 61 50.40509 48.66667
8. 1 8 65 50.40509 48.66667
9. 1 9 72 50.40509 48.66667
10. 2 1 22.5 50.40509 51.33333
11. 2 2 30.5 50.40509 51.33333
12. 2 3 40.5 50.40509 51.33333
13. 2 4 45 50.40509 51.33333
14. 2 5 51 50.40509 51.33333
15. 2 6 58.5 50.40509 51.33333
</code></pre>

<h2 id="looking-at-missing-data">Looking at missing data</h2>

<p>You can also use <code>egen</code> to generate a variable to examine missing data on each row. This can be particularly important when you are generating scale variables, or variables that will be combining values of multiple variables. For example, in the pig data above, if they were to weigh the pigs a second time (weight2) and create a variable of the difference between Time 1 and 2, if any pig were missing one of the time points, the difference score would not be accurate. In this hypothetical example, you could use <code>egen</code> combined with <code>rowmiss</code> to create a missing variable to examine this:</p>

<pre><code>egen missing = rowmiss(weight weight2)
</code></pre>

<p>Then you can use the tabulate command to identify if any values are missing:</p>

<pre><code>tabulate missing
</code></pre>

<p><img src="/assets/tabulate_missing1.png" alt="tabulate.missing1.png" /></p>

<p>Take a look at the other functions of <code>egen</code>–they’re remarkably useful.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2010/11/16/amos-introduction/">
        AMOS: Introduction
      </a>
    </h1>

    <span class="post-date">16 Nov 2010</span>
    <h1 id="introduction-to-amos">Introduction to AMOS</h1>

<p>These screencasts will introduce you to the basic interface of AMOS.</p>

<h2 id="part-i">Part I</h2>
<p><object width="560" height="340"><param name="movie" value="http://www.youtube.com/v/GA2hco5604M?fs=1&amp;hl=en_US&amp;hd=1" /><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><embed src="http://www.youtube.com/v/GA2hco5604M?fs=1&amp;hl=en_US&amp;hd=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="560" height="340" /></object></p>

<h2 id="part-ii">Part II</h2>

<p><object width="560" height="340"><param name="movie" value="http://www.youtube.com/v/6tZFOsp7vfw?fs=1&amp;hl=en_US&amp;hd=1" /><param name="allowFullScreen" value="true" /><param name="allowscriptaccess" value="always" /><embed src="http://www.youtube.com/v/6tZFOsp7vfw?fs=1&amp;hl=en_US&amp;hd=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="560" height="340" /></object></p>

  </div>
  
</div>


<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>
	  	

    </div>

  </body>
</html>
